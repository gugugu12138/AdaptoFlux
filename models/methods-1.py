import math
import random
import numpy as np

# =====================================================================
# ğŸŸ¢ åŸºç¡€æ•°å€¼æ“ä½œç±»
# =====================================================================

def return_value(x):
    """
    è¿”å›åŸæ•°å€¼
    :param x: è¾“å…¥æ•°å€¼
    :return: åŸæ•°å€¼
    """
    return [x]

def add_values(x, y):
    """
    å°†ä¸¤ä¸ªæ•°å€¼ç›¸åŠ 
    :param x: ç¬¬ä¸€ä¸ªæ•°
    :param y: ç¬¬äºŒä¸ªæ•°
    :return: ä¸¤æ•°ä¹‹å’Œ
    """
    return [x + y]

def calculate_difference(a, b):
    """
    è®¡ç®—ä¸¤ä¸ªæ•°å€¼çš„å·®
    :param a: ç¬¬ä¸€ä¸ªæ•°
    :param b: ç¬¬äºŒä¸ªæ•°
    :return: å·®å€¼
    """
    return [a - b]

def multiply_values(x, y):
    """
    å°†ä¸¤ä¸ªæ•°å€¼ç›¸ä¹˜
    :param x: ç¬¬ä¸€ä¸ªæ•°
    :param y: ç¬¬äºŒä¸ªæ•°
    :return: ä¸¤æ•°ä¹‹ç§¯
    """
    return [x * y]

# =====================================================================
# ğŸŸ¡ å¤šè¾“å‡º/å¤åˆ¶ç±»
# =====================================================================

def return_values(x):
    """
    è¿”å›ä¸‰ä¸ªåŸå€¼
    :param x: è¾“å…¥æ•°å€¼
    :return: åŸæ•°å€¼ä¸‰æ¬¡
    """
    return [x, x, x]

def ignore(x):
    """
    å¿½ç•¥è¯¥æ•°å€¼
    """
    return []

# =====================================================================
# ğŸ”µ å–æ•´ä¸å˜æ¢ç±»
# =====================================================================

def ceil_number(number):
    """
    å‘ä¸Šå–æ•´
    :param number: è¾“å…¥æ•°å€¼
    :return: å‘ä¸Šå–æ•´åçš„å€¼
    """
    return [math.ceil(number)]

def floor_number(number):
    """
    å‘ä¸‹å–æ•´
    :param number: è¾“å…¥æ•°å€¼
    :return: å‘ä¸‹å–æ•´åçš„å€¼
    """
    return [math.floor(number)]

def round_number(number):
    """
    å››èˆäº”å…¥
    :param number: è¾“å…¥æ•°å€¼
    :return: å››èˆäº”å…¥åçš„å€¼
    """
    return [round(number)]

# =====================================================================
# ğŸŸ£ éçº¿æ€§æ¿€æ´»å‡½æ•°ï¼ˆæ¨¡æ‹Ÿç¥ç»å…ƒï¼‰
# =====================================================================

def sigmoid(x):
    """
    Sigmoid æ¿€æ´»å‡½æ•°
    :param x: è¾“å…¥æ•°å€¼
    :return: ç»è¿‡ sigmoid æ˜ å°„åçš„å€¼
    """
    return [1 / (1 + math.exp(-x))]

def relu(x):
    """
    ReLU æ¿€æ´»å‡½æ•°
    :param x: è¾“å…¥æ•°å€¼
    :return: max(0, x)
    """
    return [x if x > 0 else 0]

def tanh(x):
    """
    Tanh æ¿€æ´»å‡½æ•°
    :param x: è¾“å…¥æ•°å€¼
    :return: Tanh(x)
    """
    return [math.tanh(x)]

# =====================================================================
# ğŸŸ  ç»Ÿè®¡ç±»å‡½æ•°ï¼ˆå¢å¼ºç‰¹å¾æŠ½è±¡èƒ½åŠ›ï¼‰æ²¡åšé€‚é…æ
# =====================================================================

def mean_value(a, b, c):
    """
    è¿”å›ä¸‰ä¸ªè¾“å…¥å€¼çš„å‡å€¼
    :param a: ç¬¬ä¸€ä¸ªæ•°å€¼
    :param b: ç¬¬äºŒä¸ªæ•°å€¼
    :param c: ç¬¬ä¸‰ä¸ªæ•°å€¼
    :return: å‡å€¼ï¼ˆä½œä¸ºå•å…ƒç´ åˆ—è¡¨ï¼‰
    """
    return [np.mean([a, b, c])]

def max_value(a, b, c):
    """
    è¿”å›ä¸‰ä¸ªè¾“å…¥å€¼çš„æœ€å¤§å€¼
    :param a: ç¬¬ä¸€ä¸ªæ•°å€¼
    :param b: ç¬¬äºŒä¸ªæ•°å€¼
    :param c: ç¬¬ä¸‰ä¸ªæ•°å€¼
    :return: æœ€å¤§å€¼ï¼ˆä½œä¸ºå•å…ƒç´ åˆ—è¡¨ï¼‰
    """
    return [max([a, b, c])]

def min_value(a, b, c):
    """
    è¿”å›ä¸‰ä¸ªè¾“å…¥å€¼çš„æœ€å°å€¼
    :param a: ç¬¬ä¸€ä¸ªæ•°å€¼
    :param b: ç¬¬äºŒä¸ªæ•°å€¼
    :param c: ç¬¬ä¸‰ä¸ªæ•°å€¼
    :return: æœ€å°å€¼ï¼ˆä½œä¸ºå•å…ƒç´ åˆ—è¡¨ï¼‰
    """
    return [min([a, b, c])]

def std_deviation(a, b, c):
    """
    è¿”å›ä¸‰ä¸ªè¾“å…¥å€¼çš„æ ‡å‡†å·®
    :param a: ç¬¬ä¸€ä¸ªæ•°å€¼
    :param b: ç¬¬äºŒä¸ªæ•°å€¼
    :param c: ç¬¬ä¸‰ä¸ªæ•°å€¼
    :return: æ ‡å‡†å·®ï¼ˆä½œä¸ºå•å…ƒç´ åˆ—è¡¨ï¼‰
    """
    return [np.std([a, b, c])]

# =====================================================================
# ğŸŸ¤ åˆ†ç±»å‹å¥½å‹å‡½æ•°ï¼ˆå…³é”®ï¼šè¾“å‡º 10 ç»´å‘é‡ï¼‰
# =====================================================================

def project_to_10_dim(x):
    """
    å°†è¾“å…¥æ˜ å°„åˆ° 10 ç»´ç©ºé—´ï¼ˆæ¨¡æ‹Ÿç±»åˆ«å¾—åˆ†ï¼‰
    :param x: è¾“å…¥æ•°å€¼
    :return: é•¿åº¦ä¸º 10 çš„æ•°ç»„
    """
    base = [0.1] * 10
    index = int(np.clip(round(x) % 10, 0, 9))
    base[index] += abs(x) % 1
    return base

def normalize_to_softmax(x0, x1, x2, x3, x4, x5, x6, x7, x8, x9):
    """
    å½’ä¸€åŒ–ä¸º softmax-like è¾“å‡ºï¼ˆæ¦‚ç‡åˆ†å¸ƒï¼‰
    :param x0~x9: åä¸ªè¾“å…¥æ•°å€¼
    :return: æ¦‚ç‡åˆ†å¸ƒï¼ˆé•¿åº¦ä¸º 10 çš„ listï¼‰
    """
    values = np.array([x0, x1, x2, x3, x4, x5, x6, x7, x8, x9])
    exp_values = np.exp(values - np.max(values))  # é˜²æ­¢æ•°å€¼æº¢å‡º
    return (exp_values / exp_values.sum()).tolist()