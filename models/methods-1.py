import math
import random
import numpy as np

# =====================================================================
# ğŸŸ¢ åŸºç¡€æ•°å€¼æ“ä½œç±»
# =====================================================================

def return_value(x):
    """
    è¿”å›åŸæ•°å€¼
    :param x: è¾“å…¥æ•°å€¼
    :return: åŸæ•°å€¼
    """
    return [x]

def add_values(x, y):
    """
    å°†ä¸¤ä¸ªæ•°å€¼ç›¸åŠ 
    :param x: ç¬¬ä¸€ä¸ªæ•°
    :param y: ç¬¬äºŒä¸ªæ•°
    :return: ä¸¤æ•°ä¹‹å’Œ
    """
    return [x + y]

def calculate_difference(a, b):
    """
    è®¡ç®—ä¸¤ä¸ªæ•°å€¼çš„å·®
    :param a: ç¬¬ä¸€ä¸ªæ•°
    :param b: ç¬¬äºŒä¸ªæ•°
    :return: å·®å€¼
    """
    return [a - b]

def multiply_values(x, y):
    """
    å°†ä¸¤ä¸ªæ•°å€¼ç›¸ä¹˜
    :param x: ç¬¬ä¸€ä¸ªæ•°
    :param y: ç¬¬äºŒä¸ªæ•°
    :return: ä¸¤æ•°ä¹‹ç§¯
    """
    return [x * y]

# =====================================================================
# ğŸŸ¡ å¤šè¾“å‡º/å¤åˆ¶ç±»
# =====================================================================

def return_values(x):
    """
    è¿”å›ä¸‰ä¸ªåŸå€¼
    :param x: è¾“å…¥æ•°å€¼
    :return: åŸæ•°å€¼ä¸‰æ¬¡
    """
    return [x, x, x]

def ignore(x):
    """
    å¿½ç•¥è¯¥æ•°å€¼
    """
    return []

# =====================================================================
# ğŸ”µ å–æ•´ä¸å˜æ¢ç±»
# =====================================================================

def ceil_number(number):
    """
    å‘ä¸Šå–æ•´
    :param number: è¾“å…¥æ•°å€¼
    :return: å‘ä¸Šå–æ•´åçš„å€¼
    """
    return [math.ceil(number)]

def floor_number(number):
    """
    å‘ä¸‹å–æ•´
    :param number: è¾“å…¥æ•°å€¼
    :return: å‘ä¸‹å–æ•´åçš„å€¼
    """
    return [math.floor(number)]

def round_number(number):
    """
    å››èˆäº”å…¥
    :param number: è¾“å…¥æ•°å€¼
    :return: å››èˆäº”å…¥åçš„å€¼
    """
    return [round(number)]

# =====================================================================
# ğŸŸ£ éçº¿æ€§æ¿€æ´»å‡½æ•°ï¼ˆæ¨¡æ‹Ÿç¥ç»å…ƒï¼‰
# =====================================================================

def sigmoid(x):
    """
    Sigmoid æ¿€æ´»å‡½æ•°
    :param x: è¾“å…¥æ•°å€¼
    :return: ç»è¿‡ sigmoid æ˜ å°„åçš„å€¼
    """
    return [1 / (1 + math.exp(-x))]

def relu(x):
    """
    ReLU æ¿€æ´»å‡½æ•°
    :param x: è¾“å…¥æ•°å€¼
    :return: max(0, x)
    """
    return [x if x > 0 else 0]

def tanh(x):
    """
    Tanh æ¿€æ´»å‡½æ•°
    :param x: è¾“å…¥æ•°å€¼
    :return: Tanh(x)
    """
    return [math.tanh(x)]

# =====================================================================
# ğŸŸ  ç»Ÿè®¡ç±»å‡½æ•°ï¼ˆå¢å¼ºç‰¹å¾æŠ½è±¡èƒ½åŠ›ï¼‰
# =====================================================================

def mean_value(values):
    """
    è¿”å›è¾“å…¥æ•°ç»„çš„å‡å€¼
    :param values: è¾“å…¥æ•°ç»„
    :return: å‡å€¼
    """
    return [np.mean(values)]

def max_value(values):
    """
    è¿”å›è¾“å…¥æ•°ç»„çš„æœ€å¤§å€¼
    :param values: è¾“å…¥æ•°ç»„
    :return: æœ€å¤§å€¼
    """
    return [max(values)]

def min_value(values):
    """
    è¿”å›è¾“å…¥æ•°ç»„çš„æœ€å°å€¼
    :param values: è¾“å…¥æ•°ç»„
    :return: æœ€å°å€¼
    """
    return [min(values)]

def std_deviation(values):
    """
    è¿”å›è¾“å…¥æ•°ç»„çš„æ ‡å‡†å·®
    :param values: è¾“å…¥æ•°ç»„
    :return: æ ‡å‡†å·®
    """
    return [np.std(values)]

# =====================================================================
# ğŸŸ¤ åˆ†ç±»å‹å¥½å‹å‡½æ•°ï¼ˆå…³é”®ï¼šè¾“å‡º 10 ç»´å‘é‡ï¼‰
# =====================================================================

def project_to_10_dim(x):
    """
    å°†è¾“å…¥æ˜ å°„åˆ° 10 ç»´ç©ºé—´ï¼ˆæ¨¡æ‹Ÿç±»åˆ«å¾—åˆ†ï¼‰
    :param x: è¾“å…¥æ•°å€¼
    :return: é•¿åº¦ä¸º 10 çš„æ•°ç»„
    """
    base = [0.1] * 10
    index = int(np.clip(round(x) % 10, 0, 9))
    base[index] += abs(x) % 1
    return base

def normalize_to_softmax(values):
    """
    å½’ä¸€åŒ–ä¸º softmax-like è¾“å‡ºï¼ˆæ¦‚ç‡åˆ†å¸ƒï¼‰
    :param values: è¾“å…¥æ•°ç»„ï¼ˆé•¿åº¦åº”ä¸º 10ï¼‰
    :return: æ¦‚ç‡åˆ†å¸ƒ
    """
    exp_values = np.exp(values - np.max(values))
    return (exp_values / exp_values.sum()).tolist() 